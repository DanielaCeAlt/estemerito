{"version":3,"sources":["turbopack:///[project]/src/app/api/equipos/reports/route.ts","turbopack:///[project]/node_modules/next/dist/esm/build/templates/app-route.js"],"sourcesContent":["// =============================================\n// API: REPORTES AVANZADOS DE EQUIPOS\n// =============================================\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { executeQuery } from '@/lib/database';\nimport { ApiResponse } from '@/types/database';\n\n// Interfaces para tipado de reportes\ninterface EquipoReporte {\n  no_serie: string;\n  nombreEquipo: string;\n  modelo: string;\n  marca: string;\n  estatus: string;\n  tipoEquipo: string;\n  sucursal: string;\n  valorEstimado: number;\n  fecha_adquisicion: string;\n  ubicacionActual: string;\n  responsable: string;\n  // Agregar otras propiedades según las queries específicas\n}\n\ninterface MovimientoReporte {\n  no_serie: string;\n  totalMovimientos: number;\n  tipoMovimiento: string;\n  fecha: string;\n  tecnico: string;\n  // Agregar otras propiedades según las queries específicas\n}\n\ninterface MantenimientoReporte {\n  no_serie: string;\n  tecnico: string;\n  tipo_mantenimiento: string;\n  fecha: string;\n  costoEstimado: number;\n  totalHorasEstimadas: number;\n  cantidadMantenimientos: number;\n  horasReales: number;\n  porcentajeUtilizacion: number;\n  estatusActual: string;\n  sucursal: string;\n  zona: string;\n  // Agregar otras propiedades según las queries específicas\n}\n\n// GET: Generar reportes específicos de equipos\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const tipoReporte = searchParams.get('tipo');\n    const sucursal = searchParams.get('sucursal');\n    const fechaDesde = searchParams.get('fechaDesde');\n    const fechaHasta = searchParams.get('fechaHasta');\n    const formato = searchParams.get('formato') || 'json'; // json, csv, excel\n\n    if (!tipoReporte) {\n      return NextResponse.json({\n        success: false,\n        error: 'Tipo de reporte es requerido'\n      } as ApiResponse<any>, { status: 400 });\n    }\n\n    let reporteData;\n\n    switch (tipoReporte) {\n      case 'inventario-completo':\n        reporteData = await generarReporteInventarioCompleto(sucursal);\n        break;\n      \n      case 'equipos-por-estatus':\n        reporteData = await generarReporteEquiposPorEstatus(sucursal);\n        break;\n      \n      case 'movimientos-frecuentes':\n        reporteData = await generarReporteMovimientosFrecuentes(fechaDesde, fechaHasta, sucursal);\n        break;\n      \n      case 'mantenimientos-pendientes':\n        reporteData = await generarReporteMantenimientosPendientes(sucursal);\n        break;\n      \n      case 'utilizacion-equipos':\n        reporteData = await generarReporteUtilizacionEquipos(fechaDesde, fechaHasta, sucursal);\n        break;\n      \n      case 'equipos-obsoletos':\n        reporteData = await generarReporteEquiposObsoletos(sucursal);\n        break;\n      \n      case 'costo-mantenimiento':\n        reporteData = await generarReporteCostoMantenimiento(fechaDesde, fechaHasta, sucursal);\n        break;\n      \n      case 'eficiencia-sucursales':\n        reporteData = await generarReporteEficienciaSucursales(fechaDesde, fechaHasta);\n        break;\n      \n      default:\n        return NextResponse.json({\n          success: false,\n          error: 'Tipo de reporte no válido'\n        } as ApiResponse<any>, { status: 400 });\n    }\n\n    // Si se solicita formato CSV, convertir datos\n    if (formato === 'csv') {\n      const csvData = convertirACSV((reporteData as any).equipos || (reporteData as any).datos || []);\n      return new NextResponse(csvData, {\n        headers: {\n          'Content-Type': 'text/csv',\n          'Content-Disposition': `attachment; filename=\"${tipoReporte}-${new Date().toISOString().split('T')[0]}.csv\"`\n        }\n      });\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: reporteData,\n      tipoReporte,\n      generadoEn: new Date().toISOString(),\n      parametros: {\n        sucursal,\n        fechaDesde,\n        fechaHasta,\n        formato\n      }\n    } as ApiResponse<any>, { status: 200 });\n\n  } catch (error) {\n    console.error('Error generando reporte:', error);\n    return NextResponse.json({\n      success: false,\n      error: 'Error interno del servidor'\n    } as ApiResponse<any>, { status: 500 });\n  }\n}\n\n// Función para reporte de inventario completo\nasync function generarReporteInventarioCompleto(sucursal?: string | null) {\n  let whereClause = '';\n  const queryParams: string[] = [];\n\n  if (sucursal) {\n    whereClause = 'WHERE s.id = ?';\n    queryParams.push(sucursal);\n  }\n\n  const query = `\n    SELECT \n      e.no_serie,\n      e.nombreEquipo,\n      e.modelo,\n      e.numeroActivo,\n      e.fechaAlta,\n      te.nombre AS tipoEquipo,\n      ee.nombre AS estatus,\n      s.nombre AS sucursal,\n      l.nombre AS area,\n      z.nombre AS zona,\n      est.nombre AS estado,\n      m.nombre AS municipio,\n      u.nombre AS responsable,\n      DATEDIFF(CURDATE(), e.fechaAlta) AS diasEnSistema,\n      -- Valor estimado basado en tipo de equipo\n      CASE te.nombre\n        WHEN 'NVR' THEN 15000\n        WHEN 'DVR' THEN 8000\n        WHEN 'Camara PTZ' THEN 12000\n        WHEN 'Camara 360' THEN 6000\n        WHEN 'Camara Domo' THEN 4000\n        WHEN 'Switch' THEN 3000\n        ELSE 1000\n      END AS valorEstimado\n    FROM equipo e\n    INNER JOIN tipoequipo te ON e.idTipoEquipo = te.id\n    INNER JOIN estatusequipo ee ON e.idEstatus = ee.id\n    INNER JOIN usuarios u ON e.idUsuarios = u.id\n    INNER JOIN layout l ON e.idLayout = l.id\n    INNER JOIN sucursales s ON l.centro = s.id\n    INNER JOIN zonas z ON s.zona = z.id\n    INNER JOIN estados est ON s.estado = est.id\n    INNER JOIN municipios m ON s.municipio = m.id\n    ${whereClause}\n    ORDER BY s.nombre, te.nombre, e.nombreEquipo\n  `;\n\n  const equipos = await executeQuery<EquipoReporte>(query, queryParams);\n\n  // Calcular estadísticas\n  const resumen = {\n    totalEquipos: equipos.length,\n    valorTotalEstimado: equipos.reduce((sum: number, e) => sum + (e.valorEstimado || 0), 0),\n    porEstatus: equipos.reduce((acc: Record<string, number>, e) => {\n      const estatus = String(e.estatus || 'Sin Estado');\n      acc[estatus] = (acc[estatus] || 0) + 1;\n      return acc;\n    }, {}),\n    porTipo: equipos.reduce((acc: Record<string, number>, e) => {\n      const tipo = String(e.tipoEquipo || 'Sin Tipo');\n      acc[tipo] = (acc[tipo] || 0) + 1;\n      return acc;\n    }, {}),\n    porSucursal: equipos.reduce((acc: Record<string, number>, e) => {\n      const sucursal = String(e.sucursal || 'Sin Sucursal');\n      acc[sucursal] = (acc[sucursal] || 0) + 1;\n      return acc;\n    }, {})\n  };\n\n  return {\n    resumen,\n    equipos,\n    metadatos: {\n      tipoReporte: 'inventario-completo',\n      filtros: { sucursal }\n    }\n  };\n}\n\n// Función para reporte de equipos por estatus\nasync function generarReporteEquiposPorEstatus(sucursal?: string | null) {\n  let whereClause = '';\n  const queryParams: string[] = [];\n\n  if (sucursal) {\n    whereClause = 'WHERE s.id = ?';\n    queryParams.push(sucursal);\n  }\n\n  const query = `\n    SELECT \n      ee.nombre AS estatus,\n      te.nombre AS tipoEquipo,\n      s.nombre AS sucursal,\n      COUNT(*) AS cantidad,\n      GROUP_CONCAT(e.no_serie SEPARATOR ', ') AS equipos,\n      AVG(DATEDIFF(CURDATE(), e.fechaAlta)) AS promedioDiasEnEstatus\n    FROM equipo e\n    INNER JOIN tipoequipo te ON e.idTipoEquipo = te.id\n    INNER JOIN estatusequipo ee ON e.idEstatus = ee.id\n    INNER JOIN layout l ON e.idLayout = l.id\n    INNER JOIN sucursales s ON l.centro = s.id\n    ${whereClause}\n    GROUP BY ee.nombre, te.nombre, s.nombre\n    ORDER BY ee.nombre, cantidad DESC\n  `;\n\n  const datos = await executeQuery(query, queryParams);\n\n  return {\n    datos,\n    resumen: {\n      totalCombinaciones: datos.length,\n      estatusUnicos: [...new Set(datos.map((d: Record<string, unknown>) => d.estatus))],\n      tiposUnicos: [...new Set(datos.map((d: Record<string, unknown>) => d.tipoEquipo))]\n    }\n  };\n}\n\n// Función para reporte de movimientos frecuentes\nasync function generarReporteMovimientosFrecuentes(\n  fechaDesde?: string | null, \n  fechaHasta?: string | null, \n  sucursal?: string | null\n) {\n  const whereConditions = [];\n  const queryParams: string[] = [];\n\n  if (fechaDesde) {\n    whereConditions.push('DATE(mi.fecha) >= ?');\n    queryParams.push(fechaDesde);\n  }\n\n  if (fechaHasta) {\n    whereConditions.push('DATE(mi.fecha) <= ?');\n    queryParams.push(fechaHasta);\n  }\n\n  if (sucursal) {\n    whereConditions.push('(mi.origen_idCentro = ? OR mi.destino_idCentro = ?)');\n    queryParams.push(sucursal, sucursal);\n  }\n\n  const whereClause = whereConditions.length > 0 \n    ? `WHERE ${whereConditions.join(' AND ')}`\n    : '';\n\n  const query = `\n    SELECT \n      e.no_serie,\n      e.nombreEquipo,\n      COUNT(mi.id) AS totalMovimientos,\n      tm.nombre AS tipoMovimientoMasFrecuente,\n      MAX(mi.fecha) AS ultimoMovimiento,\n      AVG(CASE \n        WHEN mi.fechaFin IS NOT NULL \n        THEN DATEDIFF(mi.fechaFin, mi.fecha)\n        ELSE NULL\n      END) AS promedioDuracionMovimientos\n    FROM equipo e\n    LEFT JOIN movimientoinventario mi ON e.no_serie = mi.no_serie\n    LEFT JOIN tipomovimiento tm ON mi.idTipoMov = tm.id\n    ${whereClause}\n    GROUP BY e.no_serie, e.nombreEquipo\n    HAVING totalMovimientos > 0\n    ORDER BY totalMovimientos DESC\n    LIMIT 50\n  `;\n\n  const equiposConMovimientos = await executeQuery<MovimientoReporte>(query, queryParams);\n\n  return {\n    equiposConMovimientos,\n    resumen: {\n      equiposAnalizados: equiposConMovimientos.length,\n      totalMovimientos: equiposConMovimientos.reduce((sum: number, e) => sum + (e.totalMovimientos || 0), 0),\n      promedioMovimientosPorEquipo: equiposConMovimientos.length > 0 \n        ? equiposConMovimientos.reduce((sum: number, e) => sum + (e.totalMovimientos || 0), 0) / equiposConMovimientos.length \n        : 0\n    }\n  };\n}\n\n// Función para reporte de mantenimientos pendientes\nasync function generarReporteMantenimientosPendientes(sucursal?: string | null) {\n  const whereConditions = ['tm.nombre = \"MANTENIMIENTO\"', 'em.nombre = \"ABIERTO\"'];\n  const queryParams: string[] = [];\n\n  if (sucursal) {\n    whereConditions.push('s.id = ?');\n    queryParams.push(sucursal);\n  }\n\n  const query = `\n    SELECT \n      mi.id AS idMantenimiento,\n      e.no_serie,\n      e.nombreEquipo,\n      te.nombre AS tipoEquipo,\n      mi.fecha AS fechaProgramada,\n      mi.tipo_mantenimiento,\n      mi.prioridad_mantenimiento,\n      mi.estimacion_horas,\n      u.nombre AS tecnicoAsignado,\n      s.nombre AS sucursal,\n      l.nombre AS area,\n      DATEDIFF(CURDATE(), mi.fecha) AS diasVencido,\n      CASE \n        WHEN DATEDIFF(CURDATE(), mi.fecha) > 7 THEN 'URGENTE'\n        WHEN DATEDIFF(CURDATE(), mi.fecha) > 3 THEN 'ATRASADO'\n        WHEN DATEDIFF(CURDATE(), mi.fecha) > 0 THEN 'VENCIDO'\n        ELSE 'EN_TIEMPO'\n      END AS estadoVencimiento\n    FROM movimientoinventario mi\n    INNER JOIN tipomovimiento tm ON mi.idTipoMov = tm.id\n    INNER JOIN estatusmovimiento em ON mi.idEstatusMov = em.id\n    INNER JOIN equipo e ON mi.no_serie = e.no_serie\n    INNER JOIN tipoequipo te ON e.idTipoEquipo = te.id\n    INNER JOIN usuarios u ON mi.idUsuarios = u.id\n    INNER JOIN layout l ON e.idLayout = l.id\n    INNER JOIN sucursales s ON l.centro = s.id\n    WHERE ${whereConditions.join(' AND ')}\n    ORDER BY diasVencido DESC, mi.prioridad_mantenimiento\n  `;\n\n  const mantenimientosPendientes = await executeQuery(query, queryParams);\n\n  return {\n    mantenimientosPendientes,\n    resumen: {\n      total: mantenimientosPendientes.length,\n      urgentes: mantenimientosPendientes.filter((m: Record<string, unknown>) => m.estadoVencimiento === 'URGENTE').length,\n      atrasados: mantenimientosPendientes.filter((m: Record<string, unknown>) => m.estadoVencimiento === 'ATRASADO').length,\n      vencidos: mantenimientosPendientes.filter((m: Record<string, unknown>) => m.estadoVencimiento === 'VENCIDO').length,\n      enTiempo: mantenimientosPendientes.filter((m: Record<string, unknown>) => m.estadoVencimiento === 'EN_TIEMPO').length\n    }\n  };\n}\n\n// Función para reporte de utilización de equipos\nasync function generarReporteUtilizacionEquipos(\n  fechaDesde?: string | null, \n  fechaHasta?: string | null, \n  sucursal?: string | null\n) {\n  // Implementación simplificada\n  const equipos = await executeQuery<MantenimientoReporte>(`\n    SELECT \n      e.no_serie,\n      e.nombreEquipo,\n      te.nombre AS tipoEquipo,\n      ee.nombre AS estatusActual,\n      s.nombre AS sucursal,\n      COUNT(mi.id) AS totalMovimientos,\n      CASE ee.nombre\n        WHEN 'En uso' THEN 100\n        WHEN 'Disponible' THEN 50\n        WHEN 'Mantenimiento' THEN 0\n        WHEN 'Dañado' THEN 0\n        ELSE 25\n      END AS porcentajeUtilizacion\n    FROM equipo e\n    INNER JOIN tipoequipo te ON e.idTipoEquipo = te.id\n    INNER JOIN estatusequipo ee ON e.idEstatus = ee.id\n    INNER JOIN layout l ON e.idLayout = l.id\n    INNER JOIN sucursales s ON l.centro = s.id\n    LEFT JOIN movimientoinventario mi ON e.no_serie = mi.no_serie\n    ${sucursal ? 'WHERE s.id = ?' : ''}\n    GROUP BY e.no_serie\n    ORDER BY porcentajeUtilizacion DESC\n  `, sucursal ? [sucursal] : []);\n\n  return {\n    equipos,\n    resumen: {\n      utilizacionPromedio: equipos.reduce((sum: number, e: MantenimientoReporte) => sum + (e.porcentajeUtilizacion || 0), 0) / equipos.length,\n      equiposEnUso: equipos.filter((e: MantenimientoReporte) => String(e.estatusActual) === 'En uso').length,\n      equiposDisponibles: equipos.filter((e: MantenimientoReporte) => String(e.estatusActual) === 'Disponible').length,\n      equiposInactivos: equipos.filter((e: MantenimientoReporte) => ['Mantenimiento', 'Dañado', 'Baja'].includes(String(e.estatusActual))).length\n    }\n  };\n}\n\n// Función para reporte de equipos obsoletos\nasync function generarReporteEquiposObsoletos(sucursal?: string | null) {\n  const query = `\n    SELECT \n      e.no_serie,\n      e.nombreEquipo,\n      e.modelo,\n      te.nombre AS tipoEquipo,\n      e.fechaAlta,\n      DATEDIFF(CURDATE(), e.fechaAlta) AS diasEnSistema,\n      s.nombre AS sucursal,\n      COUNT(mi.id) AS totalMovimientos,\n      MAX(mi.fecha) AS ultimoMovimiento,\n      CASE \n        WHEN DATEDIFF(CURDATE(), e.fechaAlta) > 1825 THEN 'OBSOLETO' -- 5 años\n        WHEN DATEDIFF(CURDATE(), e.fechaAlta) > 1095 THEN 'ANTIGUO' -- 3 años\n        WHEN DATEDIFF(CURDATE(), e.fechaAlta) > 730 THEN 'MADURO' -- 2 años\n        ELSE 'NUEVO'\n      END AS categoriaEdad\n    FROM equipo e\n    INNER JOIN tipoequipo te ON e.idTipoEquipo = te.id\n    INNER JOIN layout l ON e.idLayout = l.id\n    INNER JOIN sucursales s ON l.centro = s.id\n    LEFT JOIN movimientoinventario mi ON e.no_serie = mi.no_serie\n    ${sucursal ? 'WHERE s.id = ?' : ''}\n    GROUP BY e.no_serie\n    HAVING categoriaEdad IN ('OBSOLETO', 'ANTIGUO')\n    ORDER BY diasEnSistema DESC\n  `;\n\n  const equiposObsoletos = await executeQuery(query, sucursal ? [sucursal] : []);\n\n  return {\n    equiposObsoletos,\n    resumen: {\n      total: equiposObsoletos.length,\n      obsoletos: equiposObsoletos.filter((e: Record<string, unknown>) => e.categoriaEdad === 'OBSOLETO').length,\n      antiguos: equiposObsoletos.filter((e: Record<string, unknown>) => e.categoriaEdad === 'ANTIGUO').length,\n      recomendacionesReemplazo: equiposObsoletos.filter((e: Record<string, unknown>) => e.categoriaEdad === 'OBSOLETO').length\n    }\n  };\n}\n\n// Función para reporte de costo de mantenimiento\nasync function generarReporteCostoMantenimiento(\n  fechaDesde?: string | null, \n  fechaHasta?: string | null, \n  sucursal?: string | null\n) {\n  // Implementación con costos estimados\n  const costos = await executeQuery<MantenimientoReporte>(`\n    SELECT \n      s.nombre AS sucursal,\n      te.nombre AS tipoEquipo,\n      mi.tipo_mantenimiento,\n      COUNT(*) AS cantidadMantenimientos,\n      SUM(mi.estimacion_horas) AS totalHorasEstimadas,\n      SUM(mi.estimacion_horas * 350) AS costoEstimado -- $350 por hora técnico\n    FROM movimientoinventario mi\n    INNER JOIN tipomovimiento tm ON mi.idTipoMov = tm.id\n    INNER JOIN equipo e ON mi.no_serie = e.no_serie\n    INNER JOIN tipoequipo te ON e.idTipoEquipo = te.id\n    INNER JOIN layout l ON e.idLayout = l.id\n    INNER JOIN sucursales s ON l.centro = s.id\n    WHERE tm.nombre = 'MANTENIMIENTO'\n    ${fechaDesde ? 'AND DATE(mi.fecha) >= ?' : ''}\n    ${fechaHasta ? 'AND DATE(mi.fecha) <= ?' : ''}\n    ${sucursal ? 'AND s.id = ?' : ''}\n    GROUP BY s.nombre, te.nombre, mi.tipo_mantenimiento\n    ORDER BY costoEstimado DESC\n  `, [fechaDesde, fechaHasta, sucursal].filter(Boolean));\n\n  return {\n    costos,\n    resumen: {\n      costoTotal: costos.reduce((sum: number, c) => sum + (c.costoEstimado || 0), 0),\n      horasTotales: costos.reduce((sum: number, c) => sum + (c.totalHorasEstimadas || 0), 0),\n      mantenimientosTotales: costos.reduce((sum: number, c) => sum + (c.cantidadMantenimientos || 0), 0)\n    }\n  };\n}\n\n// Función para reporte de eficiencia de sucursales\nasync function generarReporteEficienciaSucursales(\n  fechaDesde?: string | null, \n  fechaHasta?: string | null\n) {\n  const eficiencia = await executeQuery<MantenimientoReporte>(`\n    SELECT \n      s.nombre AS sucursal,\n      z.nombre AS zona,\n      COUNT(DISTINCT e.no_serie) AS totalEquipos,\n      COUNT(DISTINCT CASE WHEN ee.nombre = 'En uso' THEN e.no_serie END) AS equiposEnUso,\n      COUNT(DISTINCT CASE WHEN ee.nombre = 'Disponible' THEN e.no_serie END) AS equiposDisponibles,\n      COUNT(DISTINCT CASE WHEN ee.nombre = 'Mantenimiento' THEN e.no_serie END) AS equiposEnMantenimiento,\n      COUNT(mi.id) AS totalMovimientos,\n      AVG(CASE \n        WHEN mi.fechaFin IS NOT NULL \n        THEN DATEDIFF(mi.fechaFin, mi.fecha)\n        ELSE NULL\n      END) AS promedioDuracionMovimientos,\n      (COUNT(DISTINCT CASE WHEN ee.nombre = 'En uso' THEN e.no_serie END) * 100.0 / COUNT(DISTINCT e.no_serie)) AS porcentajeUtilizacion\n    FROM sucursales s\n    INNER JOIN zonas z ON s.zona = z.id\n    INNER JOIN layout l ON s.id = l.centro\n    INNER JOIN equipo e ON l.id = e.idLayout\n    INNER JOIN estatusequipo ee ON e.idEstatus = ee.id\n    LEFT JOIN movimientoinventario mi ON e.no_serie = mi.no_serie\n    ${fechaDesde || fechaHasta ? 'WHERE' : ''}\n    ${fechaDesde ? 'DATE(mi.fecha) >= ?' : ''}\n    ${fechaDesde && fechaHasta ? 'AND' : ''}\n    ${fechaHasta ? 'DATE(mi.fecha) <= ?' : ''}\n    GROUP BY s.id, s.nombre, z.nombre\n    ORDER BY porcentajeUtilizacion DESC\n  `, [fechaDesde, fechaHasta].filter(Boolean));\n\n  return {\n    eficiencia,\n    resumen: {\n      sucursalMasEficiente: eficiencia[0]?.sucursal || 'N/A',\n      promedioUtilizacion: eficiencia.length > 0 ? eficiencia.reduce((sum: number, e) => sum + (e.porcentajeUtilizacion || 0), 0) / eficiencia.length : 0\n    }\n  };\n}\n\n// Función para convertir datos a CSV\nfunction convertirACSV(data: Record<string, unknown>[]): string {\n  if (!data || data.length === 0) return '';\n  \n  const headers = Object.keys(data[0]);\n  const csvRows = [\n    headers.join(','),\n    ...data.map(row => headers.map(header => {\n      const value = row[header];\n      return typeof value === 'string' && value.includes(',') ? `\"${value}\"` : value;\n    }).join(','))\n  ];\n  \n  return csvRows.join('\\n');\n}","import { AppRouteRouteModule } from \"next/dist/esm/server/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/esm/server/lib/patch-fetch\";\nimport { getRequestMeta } from \"next/dist/esm/server/request-meta\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { normalizeAppPath } from \"next/dist/esm/shared/lib/router/utils/app-paths\";\nimport { NodeNextRequest, NodeNextResponse } from \"next/dist/esm/server/base-http/node\";\nimport { NextRequestAdapter, signalFromNodeResponse } from \"next/dist/esm/server/web/spec-extension/adapters/next-request\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\nimport { getRevalidateReason } from \"next/dist/esm/server/instrumentation/utils\";\nimport { sendResponse } from \"next/dist/esm/server/send-response\";\nimport { fromNodeOutgoingHttpHeaders, toNodeOutgoingHttpHeaders } from \"next/dist/esm/server/web/utils\";\nimport { getCacheControlHeader } from \"next/dist/esm/server/lib/cache-control\";\nimport { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from \"next/dist/esm/lib/constants\";\nimport { NoFallbackError } from \"next/dist/esm/shared/lib/no-fallback-error.external\";\nimport { CachedRouteKind } from \"next/dist/esm/server/response-cache\";\nimport * as userland from \"INNER_APP_ROUTE\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/equipos/reports/route\",\n        pathname: \"/api/equipos/reports\",\n        filename: \"route\",\n        bundlePath: \"\"\n    },\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n    resolvedPagePath: \"[project]/src/app/api/equipos/reports/route.ts\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return _patchFetch({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\nexport { routeModule, workAsyncStorage, workUnitAsyncStorage, serverHooks, patchFetch,  };\nexport async function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/equipos/reports/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    } else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = process.env.__NEXT_MULTI_ZONE_DRAFT_MODE;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = normalizeAppPath(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = getTracer();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: getRequestMeta(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new NodeNextRequest(req);\n    const nodeNextRes = new NodeNextResponse(res);\n    const nextReq = NextRequestAdapter.fromNodeNextRequest(nodeNextReq, signalFromNodeResponse(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!getRequestMeta(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = toNodeOutgoingHttpHeaders(response.headers);\n                        if (cacheTags) {\n                            headers[NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await sendResponse(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: getRevalidateReason({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!getRequestMeta(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers);\n            if (!(getRequestMeta(req, 'minimalMode') && isIsr)) {\n                headers.delete(NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', getCacheControlHeader(cacheEntry.cacheControl));\n            }\n            await sendResponse(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: getRevalidateReason({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await sendResponse(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n"],"names":[],"mappings":"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","ignoreList":[1]}